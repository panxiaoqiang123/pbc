remove(list = ls())
library(edgeR)
setwd("E:\\medicin\\??????????????????\\???????????????????????????")
exp_m1 = read.csv('??????????????????????????????.csv')
exp_m2 = read.csv('???????????????????????????.csv')


exp_m = merge(exp_m1,exp_m2,by="X")
library(dplyr)
exp_m0 = left_join(exp_m1,exp_m2,by=c("id"="X"))
write.csv(exp_m,"????????????????????????????????????.csv")
exp_m0 = read.csv('???????????????????????????????????? - ??????.csv',row.names = 1)
t_index=colnames(exp_m)
t_index <- as.data.frame(t_index)
teg = "TCGA"
t_dataSmTP <- cbind(t_index,teg)

design = data.frame('Barcode'=t_index,'Group'=teg)
write.csv(design,"????????????.csv")
design <- read.csv("????????????.csv")
design <- as.data.frame(design)
#group = ifelse(colnames(exp_m[,1:84]) %in% t_dataSmTP,'tcgaTP','tcgaNT')
#group = c(group,rep('gtexNT',ncol(exp_m)-length(group)))
#barcode=colnames(exp_m)

#design = data.frame('Barcode'=barcode,'Group'=group)

library(ggplot2)
library(ggbiplot)
exp_m_t0=as.data.frame(t(exp_m0))
exp_m_t0 <- na.omit(exp_m_t0)



pca_result1 <- prcomp(exp_m_t0,scale=T)  # ???????????????,???????????????????????????????????????????????????????????????????????????

ggbiplot(pca_result1, 
         var.axes=F,            # ????????????????????????
         obs.scale = 1,         # ???????????? 
         groups = design$Group, # ??????????????????,?????????????????????????????????
         ellipse = T,           # ???????????????????????????
         circle = F) +
  ggtitle('PCAplot_tcga') +
  xlim(-400, 400) + ylim(-400, 400) #?????????????????????
